function Explorer(fileOpener, filesLister, bus) {
    var self = this;

    this.selectFile = function (file, app) {
        bus("FileSelected").broadcast(file);
    }

    this.refreshFolder = function (filesLister, folder) {
        var newContent = filesLister(folder.path);
        folder.files = newContent.files;
        folder.folders = newContent.folders;
    }

    this.selectFolder = function (folder) {
        folder.expanded = !folder.expanded
        if (folder.expanded && folder.files.length == 0 && folder.folders.length == 0) self.refreshFolder(filesLister, folder);
    }

    this.setTree = function(tree){
        this.tree = tree;
    }

    this.tree = [{
        name: "root",
        expanded: false,
        path: "D:/Skydrive/Perso/Editor/",
        files: [],
        folders: [],
    }];
}

module.exports = Explorer;