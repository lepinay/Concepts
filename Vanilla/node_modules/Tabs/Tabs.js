function TabsEvents(bus, tabs){
    bus("SaveCurrentDocument").subscribe(function(doc){
        doc.modified = false;
    });

    bus("DocumentLoaded").subscribe(function(doc){
        tabs.addDocument(doc);
    });

    bus("DocumentSelected").subscribe(function(doc){
        tabs.selectDocument(doc.path);
    });
    
    bus("CurrentDocumentModified").subscribe(function(){
       tabs.modifyCurrentDocument();
    });
}

function Tabs(bus){
    var self = this;
    var currentDocument;

    TabsEvents(bus, self);
  
    this.selectDocument = function(path) {
        self.documents.forEach(function (d) { 
                d.selected = d.path == path;
                if(d.selected){
                    currentDocument = d;
                }
            });
    }
  
    this.addDocument = function(doc){
        self.documents.push(doc);
    }
   
    this.modifyCurrentDocument = function(){
        currentDocument.modified = true;
    };
   
    this.documents = [];
}

module.exports = Tabs;